{
  "builders": [
    {
      "changes": [
        "LABEL maintainer {{user `maintainer`}}",
        "ONBUILD RUN wget -O https://tomcat.apache.org/tomcat-8.0-doc/appdev/sample/sample.war $CATALINA_BASE",
        "EXPOSE 8080",
        "CMD catalina.sh run"
      ],
      "commit": true,
      "image": "tomcat",
      "type": "docker"
    }
  ],
  "post-processors": [
      {
        "type": "docker-tag",
        "repository": "k8s_assginment/tomcat",
        "tag": "{{user `tag`}}"
      },
      {
        "type": "docker-push",
        "ecr_login": true,
        "access_key": "{{user `aws_access_key`}}",
        "secret_key": "{{user `aws_secret_key`}}",
        "login_server": "{{user `aws_ecr_url`}}"
      }
  ],
  "variables": {
    "maintainer": "\"Giordano Fechio <gfechio@gmail.com>\"",
    "aws_ecr_url": "ecr.url.aws.com",
    "tag": "tomcat-{{user `creation_timestamp`}}",
    "creation_timestamp": "{{timestamp}}"
  }
}

