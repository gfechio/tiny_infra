{
  "builders": [
    {
      "changes": [
        "LABEL maintainer {{user `maintainer`}}",
        "ONBUILD RUN wget https://tomcat.apache.org/tomcat-8.0-doc/appdev/sample/sample.war -O $CATALINA_HOME/webapps/sample.war",
        "EXPOSE 8080",
        "CMD catalina.sh run"
      ],
      "commit": true,
      "image": "tomcat",
      "type": "docker"
    }
  ],
  "post-processors": [
      {
        "type": "docker-tag",
        "repository": "k8s_assginment/tomcat",
        "tag": "{{user `tag`}}"
      },
      {
        "type": "docker-push",
        "ecr_login": true,
        "access_key": "{{user `aws_access_key`}}",
        "secret_key": "{{user `aws_secret_key`}}",
        "login_server": "{{user `aws_ecr_url`}}"
      }
  ],
  "variables": {
    "maintainer": "\"Giordano Fechio <gfechio@gmail.com>\"",
    "aws_ecr_url": "https://{{env `account_id`}}.eu-central-1.console.aws.amazon.com/",
    "tag": "tomcat-backbase"
  }
}

